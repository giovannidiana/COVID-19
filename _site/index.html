<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=973303f6d6b259caa36ea8646782eff20fed466e">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Statistical analysis of COVID-19 epidemics | Inference and predictions on the course of the outbreak</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Statistical analysis of COVID-19 epidemics" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Inference and predictions on the course of the outbreak" />
<meta property="og:description" content="Inference and predictions on the course of the outbreak" />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="Statistical analysis of COVID-19 epidemics" />
<script type="application/ld+json">
{"@type":"WebSite","url":"http://localhost:4000/","headline":"Statistical analysis of COVID-19 epidemics","name":"Statistical analysis of COVID-19 epidemics","description":"Inference and predictions on the course of the outbreak","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/giovannidiana/COVID-19">View on GitHub</a>

          <h1 id="project_title">Statistical analysis of COVID-19 epidemics</h1>
          <h2 id="project_tagline">Inference and predictions on the course of the outbreak </h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/javascript" charset="utf-8" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/javascript" charset="utf-8" src="https://vincenttam.github.io/javascripts/MathJaxLocal.js">
</script>

<script src="https://d3js.org/d3.v4.js"></script>

<script src="/js/responsiveD3.js"></script>

<p>by <strong>Giovanni Diana</strong> and <strong>Diana Passaro</strong></p>

<hr />
<ul>
  <li><a href="#intro"> Introduction </a></li>
  <li><a href="#model"> Empirical model of infection </a></li>
  <li><a href="#SIR"> The SIR model </a></li>
  <li><a href="#inference1"> Statistical inference and model predictions </a></li>
</ul>

<hr />
<ul>
  <li><a href="current_state">Summary of the outbreak by country</a></li>
  <li><a href="SM">Supplementary Methods</a></li>
</ul>

<div style="background-color:rgb(255,122,0);color:white;padding:10px">
<p style="font-size:20px"> <b>Update</b></p>

<p> 26 Mar 2020: The repository CSSEGISandData/COVID-19 is currently making major changes in the data structure. The analysis presented here will be updated soon according to the new data.</p>
</div>
<h2 id="introduction--">Introduction <a name="intro"> </a></h2>
<p>Spread of COVID-19 in early 2020 has raised important concerns about the ability of national health systems to detect the positive cases, as well as the intervention rate a country is expected to put in place to contain the infection.</p>

<p>Using data on disease spread and containment through the public repository <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData/COVID-19</a> we applied statistical inference to predict the course of the infection using two models of the outbreak.</p>

<p>In some regions of China the infection rate has significantly decreased compared to the initial exponential spread of the infection. This information can be used to estimate the spread progression in other countries.</p>

<figure>
   <center><img src="Figures/Figure_henan.png" />
   <figcaption> Figure 1a: Dynamics of the infection in the Henan province, China (last update 14/02/2020) </figcaption></center>
</figure>

<figure>
   <center><img src="Figures/Figure_stat_1.png" />
   <figcaption> Figure 1b: Dynamics of the infection in Italy (last update 14/02/2020) </figcaption></center>
</figure>

<p>First, we introduce a minimal heuristic model of the number of infections based on the disease outbreak in China. This model captures the initial exponential phase of the outbreak and the effect of the external intervention to contain the infection. Next we extend the SIR model employed to describe susceptible, infected and recovered populations to account for external interventaions.</p>

<p>For both models we employ Bayesian inference to determine model parameters and generate predictions of the future evolution of the infection.</p>

<h3 id="worldwide-analysis">Worldwide analysis</h3>
<p>For this analysis we assume that infection and recovery rates in the absence of external intervention are the same for all countries whereas all the other model parameters are country-dependent. This allows us to exploit the worldwide data to strengthen the predictive power of both models.</p>

<p>The framework of statistical inference allows us to estimate model parameters and make predictions while taking into account statistical uncertainties derived from the data and the prior uncertainty. We performed a global analysis on the areas included in the CSSE dataset [1].</p>

<p>The interactive charts below give an overview of the course of the infection for each country for the two models employed. On the left, predictions based on the heuristic model show the dynamics of the infection rate with the 90% confidence interval (red curves). On the right, the dynamics of infection (red curves) obtained with the SIR model, which includes additional features such as the recovery rate (green curves). Data are updated every day.</p>

<div id="areaHM"></div>

<p><select id="dropdown_HM"> </select></p>

<script src="/js/d3Chart_HM.js"> </script>

<p>Interactive chart 1: Heuristic model predictions. Choose the country from the dropdown button, zoom in by selecting a square region and zoom out by double click on the image.</p>

<div id="areaSIR"></div>

<p><select id="dropdown_SIR"> </select></p>

<script src="/js/d3Chart_SIR.js"> </script>

<p>Interactive chart 2: SIR model predictions.</p>

<p>While China is now at the final stage of the spread, several countries in Europe are now facing the exponential phase. By quantifying the number of infected individual at the peak predicted by our model we found that Italy, Germany, France and Iran are at high risk of pandemic spread. During the exponential phase it is really hard to draw reliable estimates of when the diffusion of the virus will start displaying a reduction, therefore it is extremely important for these countries to strenghten the interventions to contain the eponential increase of new cases.</p>

<h2 id="heuristic-model--">Heuristic model <a name="model"> </a></h2>
<p>We used a generative model to describe the dynamics of the infected population in a given geographic area. The model takes into account the effect of the local interventions by coupling the average number of infections $X(t)$ with a dynamical variable $A(t)$ which acts against the spread. The observed number of cases is then generated from a Poisson distribution with rate $X(t)\cdot p(t)$, where $p(t)$ is a fraction of the true number of infections which varies over time (due for instance to the increased number of tests during the acute phase).</p>

<p>The model is defined by two differential equations for the size of the infected population $X(t)$ and the action $A(t)$ and a probabilistic rule on the observed infections</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\frac{dX}{dt} &= (\beta-A(t))\cdot X(t),\quad X(t_0) = X_0\\
\frac{dA}{dt} &= h X(t)p(t),\quad A(t_0)=0\\
n(t) & \sim \mathrm{Poisson}(X(t) \cdot p(t)),\\
p(t)&=\frac{1}{1+\left(\frac{k}{X(t)}\right)^g}
\end{align*} %]]></script>

<p>where $\beta$ is the (observed) infection rate and $h$ quantifies the effect of local interventions.<br />
$X_0$ is the average number of infections at the initial time (22/01/2020).
The lack of observations at early stages is captured by the factor $p(t)$ which depends directly on the daily infection rate. The assumption being that the more infections are detected the more tests and controls are put in place to monitor the infected population. Note however that this is not sufficient to estimate the true number of infected individual, but to accommodate the low number of observations when the epidemics reaches a given country.</p>

<p>Figure 2 illustrates the typical dynamics of the model.</p>

<figure>
<img src="Figures/Figure_1.png" />
<figcaption> Figure 2: Dynamics of the number of infections</figcaption>
</figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">$h$</td>
      <td style="text-align: right">intervention coefficient</td>
    </tr>
    <tr>
      <td style="text-align: left">$k$</td>
      <td style="text-align: right">Hill scale</td>
    </tr>
    <tr>
      <td style="text-align: left">$g$</td>
      <td style="text-align: right">Hill shape</td>
    </tr>
    <tr>
      <td style="text-align: left">$\beta$</td>
      <td style="text-align: right">global infection rate</td>
    </tr>
    <tr>
      <td style="text-align: left">$X_0$</td>
      <td style="text-align: right">initial infected</td>
    </tr>
    <tr>
      <td style="text-align: left">$X(t)$</td>
      <td style="text-align: right">infected at time t</td>
    </tr>
    <tr>
      <td style="text-align: left">$A(t)$</td>
      <td style="text-align: right">intervention strength</td>
    </tr>
    <tr>
      <td style="text-align: left">$p(t)$</td>
      <td style="text-align: right">observed fraction of infected individuals</td>
    </tr>
  </tbody>
</table>

<p>Table 1: Summary of parameters and variable used in the model.</p>

<p>Of particular importance, the intervention coefficient $h$ describes the investment the country is putting in place to contain the epidemy (plotted in Supplementary figure 1). Linked to this parameter, the hill scale can be calculated for each country (Supplementary figure 3), and together with the hill shape $k$ (Supplementary figure 4) is indicative of the readiness of the country to put in place a containment programme.</p>

<h2 id="sir-model">SIR model<a id="SIR"></a></h2>
<p>In this section we introduce the SIR model to describe susceptible, infected and recovered individuals in a population. The intervention is accounted in two ways, first by reducing the infection rate $\beta$, and second by increasing the recovery rate $\gamma$. The first effect is due to restriction in social activity, reducing the probability of being infected, the second is due to the treatment of patients in hospitals which might improve over time.<br />
The model is characterized by the following population dynamics</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
&\frac{dI}{dt} = \frac{\beta(t)}{N}\cdot S(t)I(t)-\gamma(t)\cdot I(t),\\
&\frac{dS}{dt} = -\frac{\beta(t)}{N}\cdot S(t)I(t),\\
&\frac{dR}{dt} = \gamma(t)\cdot I(t),\\
& I(t_0) = I_0,\quad S(t_0) = N-I_0, \quad R(t_0)=0
\end{align*} %]]></script>

<p>where $S$, $I$ and $R$ are the susceptible, infected and recovered population respectively. In order to include the effect of the intervention we parameterized the time dependency of the infection rate $\beta$ and the recovery rate $\gamma$ using the Hill functions</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\beta(t) &= \beta_0\cdot\left(1+\frac{h}{1+(k/t)^g}\right)^{-1}\\
\gamma(t) &= \gamma_0\cdot\left(1+\frac{h_R}{1+(k_R/t)^{g_R}}\right)
\end{align*} %]]></script>

<p>Note that the main difference with respect to the empirical model described in the previous section where the intervention had its own dynamical equation whereas here the time dependency is entirely modeled by the Hill functions.
To include the effect of introducing tests for COVID-19 infection we modeled the observed numbers of infections and recovery as</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
I^{obs}(t)&=\nu(t) I(t)\\
R^{obs}(t)&=\nu(t) R(t)
\end{align*} %]]></script>

<p>with</p>

<script type="math/tex; mode=display">\begin{align*}
\nu(t)=\frac{\nu_\infty}{1+(k_T/t)^{g_T}}
\end{align*}</script>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: right">description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">$S$</td>
      <td style="text-align: right">Susceptible population</td>
    </tr>
    <tr>
      <td style="text-align: left">$I$</td>
      <td style="text-align: right">Infected population</td>
    </tr>
    <tr>
      <td style="text-align: left">$R$</td>
      <td style="text-align: right">Recovered population</td>
    </tr>
    <tr>
      <td style="text-align: left">$\beta$</td>
      <td style="text-align: right">time-dependent infection rate</td>
    </tr>
    <tr>
      <td style="text-align: left">$\gamma$</td>
      <td style="text-align: right">time-dependent recovery rate</td>
    </tr>
    <tr>
      <td style="text-align: left">$\nu$</td>
      <td style="text-align: right">Observed fraction of cases</td>
    </tr>
  </tbody>
</table>

<p>Table 2: Summary of parameters and variable used in the SIR model.</p>

<h2 id="statistical-inference-and-model-predictions--">Statistical inference and model predictions <a name="inference1"> </a></h2>
<p>By using the available daily reported cases in the public repository <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData/COVID-19</a> we can estimate the parameters of both the heuristic model and the SIR model from the data for each country/region affected by the infection (see current state <a href="current_state">here</a>). Knowing the model parameters allow us to draw predictions on how the epidemics will evolve.</p>

<h3 id="parameter-estimation-in-individual-areas">Parameter estimation in individual areas</h3>
<p>The framework of Bayesian statistics allows us to estimate the parameters of our model and their uncertainty by targeting their posterior distributions, namely their probability density conditional to the observed data. The uncertainty in the parameters propagates to the predicted dynamics of the infection, giving a way to explore the scenarios which are statistically compatible with the data.</p>

<p>Here we used the Markov-chain monte carlo (MCMC) approach which allows us to draw posterior samples of the parameters. We can apply this method to individual countries affected by COVID-19 outbreak and extract country-specific model parameters as shown below in the case of the UK, where no specific interventions have been applied to date. As a consequence, the exponential phase generates a pronounced uncertainty in the model prediction of the future number of infected individuals.</p>

<figure>
<center><img src="Figures/Figure_stat_UK.png" />
<figcaption> Curves generated from 100 posterior samples of model parameters obtained by using data from the UK.</figcaption>
</center>
</figure>

<h3 id="additional-figures">Additional figures</h3>

<figure>
<center><img src="Figures/Figure_ranking_peak.png" />
<figcaption> Fig. 3: Top 10 countries for maximum number of infected individuals</figcaption>
</center>
</figure>

<figure>
<center><img src="Figures/Figure_ranking_duration.png" />
<figcaption> Fig. 4: Top 10 countries by duration of the outbreak</figcaption>
</center>
</figure>

<p>The intervention coefficient is estimated from each country from the data and is a fundamental parameter to bring down the peak of infected individuals, as it is shown by testing different values of $h$ from the estimated one.</p>

<figure>
<center><img src="Figures/figpost_sir_henan.png" style="width:100%" />
<figcaption> Fig. 5: Effect of changing the intervention coefficient on the Henan dataset.</figcaption>
</center>
</figure>

<hr />

<figure>
<center><img src="Figures/Figure_SIR_Henan.png" />
<figcaption> Fig. 6: Fit of the SIR model and comparison with the Henan data.</figcaption>
</center>
</figure>

<h2 id="references">References</h2>
<ol>
  <li>Dong, Ensheng, Hongru Du, and Lauren Gardner. “An interactive web-based dashboard to track COVID-19 in real time.” The Lancet Infectious Diseases (2020).</li>
</ol>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">Statistical analysis of COVID-19 epidemics maintained by <a href="https://github.com/giovannidiana">giovannidiana</a></p>
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    
  </body>
</html>
